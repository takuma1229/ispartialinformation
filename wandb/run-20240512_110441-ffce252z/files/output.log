
/content/drive/MyDrive/research_discourse_relation/discourse_relation_explainability
/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning:
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
num_added_tokens: 16, added_special_tokens: <NOUN>,<PRONOUN>,<ADJECTIVAL-NOUN>,<PRENOUN-ADJECTIVAL>,<ADVERB>,<CONJUNCTION>,<INTERJECTION>,<VERB>,<ADJECTIVE>,<AUXILIARY-VERB>,<PARTICLE>,<PREFIX>,<SUFFIX>,<SYMBOL>,<AUXILIARY-SYMBOL>,<BLANK>
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at cl-tohoku/bert-base-japanese-v3 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()



  0%|          | 0/11 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
epoch: None 	loss: 0.065226   	accuracy: 0.2575 	precision: 0.1848 	recall: 0.2304 	f1: 0.1233
epoch: None 	loss: 0.075397   	accuracy: 0.2619 	precision: 0.1655 	recall: 0.2788 	f1: 0.1130
  0%|          | 0/15 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]




  self.pid = os.fork()[00:00<?, ?it/s]

  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  7%|▋         | 1/15 [01:45<24:31, 10/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
epoch: 0 	loss: 0.001795   	accuracy: 0.7865 	precision: 0.2677 	recall: 0.3051 	f1: 0.2843
epoch: 0 	loss: 0.027023   	accuracy: 0.7784 	precision: 0.2785 	recall: 0.3221 	f1: 0.2972
epoch: 0 	loss: 0.035933   	accuracy: 0.7381 	precision: 0.2683 	recall: 0.2973 	f1: 0.2820





  self.pid = os.fork()[00:00<?, ?it/s]
 45%|████▌     | 5/11 [00:00<00:00, 18.24it/s]
epoch: 1 	loss: 0.001434   	accuracy: 0.8412 	precision: 0.4105 	recall: 0.4303 	f1: 0.4160
epoch: 1 	loss: 0.024572   	accuracy: 0.8263 	precision: 0.4105 	recall: 0.4475 	f1: 0.4274
  self.pid = os.fork()[00:00<?, ?it/s]
 13%|█▎        | 2/15 [02:00<11:18, 52/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 13%|█▎        | 2/15 [02:15<11:18, 52.21s/it]
epoch: 2 	loss: 0.000569   	accuracy: 0.8861 	precision: 0.4737 	recall: 0.4949 	f1: 0.4680
epoch: 2 	loss: 0.024747   	accuracy: 0.8503 	precision: 0.4541 	recall: 0.4921 	f1: 0.4432
 20%|██        | 3/15 [02:15<07:04, 35/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 27%|██▋       | 4/15 [02:31<05:02, 27/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  1%|          | 1/84 [00:00<00:25,  3.27it/s]
epoch: 3 	loss: 0.000291   	accuracy: 0.9094 	precision: 0.4892 	recall: 0.5262 	f1: 0.4970
epoch: 3 	loss: 0.039914   	accuracy: 0.8563 	precision: 0.4645 	recall: 0.4608 	f1: 0.4471






  self.pid = os.fork()[00:00<?, ?it/s]
 45%|████▌     | 5/11 [00:00<00:00, 17.95it/s]
epoch: 4 	loss: 0.000120   	accuracy: 0.9333 	precision: 0.7291 	recall: 0.6925 	f1: 0.7071
epoch: 4 	loss: 0.047162   	accuracy: 0.8743 	precision: 0.6663 	recall: 0.6796 	f1: 0.6541
  self.pid = os.fork()[00:00<?, ?it/s]
 33%|███▎      | 5/15 [02:46<03:51, 23/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 40%|████      | 6/15 [03:01<03:03, 20/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
epoch: 5 	loss: 0.000069   	accuracy: 0.9573 	precision: 0.7299 	recall: 0.7555 	f1: 0.7393
epoch: 5 	loss: 0.039045   	accuracy: 0.8443 	precision: 0.5855 	recall: 0.6525 	f1: 0.5711
epoch: 5 	loss: 0.001002   	accuracy: 0.8393 	precision: 0.6183 	recall: 0.6360 	f1: 0.5944





  self.pid = os.fork()[00:00<?, ?it/s]
  9%|▉         | 1/11 [00:00<00:02,  4.95it/s]
epoch: 6 	loss: 0.000057   	accuracy: 0.9805 	precision: 0.9704 	recall: 0.8062 	f1: 0.8425
epoch: 6 	loss: 0.019715   	accuracy: 0.8862 	precision: 0.7133 	recall: 0.6129 	f1: 0.6537
  self.pid = os.fork()[00:00<?, ?it/s]
 47%|████▋     | 7/15 [03:16<02:28, 18/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 53%|█████▎    | 8/15 [03:31<02:02, 17/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
epoch: 7 	loss: 0.000040   	accuracy: 0.9835 	precision: 0.9596 	recall: 0.8570 	f1: 0.8787
epoch: 7 	loss: 0.017258   	accuracy: 0.8683 	precision: 0.6039 	recall: 0.6871 	f1: 0.5992
epoch: 7 	loss: 0.023432   	accuracy: 0.8333 	precision: 0.8220 	recall: 0.7173 	f1: 0.7192






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 60%|██████    | 9/15 [03:46<01:40, 16/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  6%|▌         | 5/84 [00:00<00:12,  6.47it/s]
epoch: 8 	loss: 0.000021   	accuracy: 0.9918 	precision: 0.9911 	recall: 0.9379 	f1: 0.9609
epoch: 8 	loss: 0.027308   	accuracy: 0.8802 	precision: 0.8324 	recall: 0.7175 	f1: 0.7476






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 45%|████▌     | 5/11 [00:00<00:00, 19.08it/s]
epoch: 9 	loss: 0.000017   	accuracy: 0.9918 	precision: 0.9845 	recall: 0.8837 	f1: 0.9174
epoch: 9 	loss: 0.025624   	accuracy: 0.8743 	precision: 0.6338 	recall: 0.6842 	f1: 0.6215
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 73%|███████▎  | 11/15 [04:17<01:03, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  2%|▏         | 2/84 [00:00<00:15,  5.31it/s]
epoch: 10 	loss: 0.000015   	accuracy: 0.9940 	precision: 0.9984 	recall: 0.9587 	f1: 0.9776
epoch: 10 	loss: 0.029194   	accuracy: 0.8922 	precision: 0.8788 	recall: 0.8342 	f1: 0.8339






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
epoch: 11 	loss: 0.000013   	accuracy: 0.9940 	precision: 0.9970 	recall: 0.9602 	f1: 0.9776
epoch: 11 	loss: 0.025692   	accuracy: 0.8922 	precision: 0.8788 	recall: 0.8342 	f1: 0.8339
epoch: 11 	loss: 0.036895   	accuracy: 0.8333 	precision: 0.7818 	recall: 0.7550 	f1: 0.7387
 80%|████████  | 12/15 [04:32<00:47, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 87%|████████▋ | 13/15 [04:47<00:31, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  1%|          | 1/84 [00:00<00:27,  2.99it/s]
epoch: 12 	loss: 0.000012   	accuracy: 0.9940 	precision: 0.9977 	recall: 0.9594 	f1: 0.9776
epoch: 12 	loss: 0.026582   	accuracy: 0.8922 	precision: 0.8788 	recall: 0.8342 	f1: 0.8339






  self.pid = os.fork()[00:00<?, ?it/s]
 82%|████████▏ | 9/11 [00:00<00:00, 24.71it/s]
epoch: 13 	loss: 0.000011   	accuracy: 0.9940 	precision: 0.9938 	recall: 0.9633 	f1: 0.9777
epoch: 13 	loss: 0.027921   	accuracy: 0.8922 	precision: 0.8788 	recall: 0.8342 	f1: 0.8339
  self.pid = os.fork()[00:00<?, ?it/s]
 93%|█████████▎| 14/15 [05:02<00:15, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 26%|██▌       | 22/84 [00:03<00:08,  7.51it/s]
 46%|████▋     | 39/84 [00:05<00:05,  8.22it/s]
 63%|██████▎   | 53/84 [00:07<00:03,  8.10it/s]
 83%|████████▎ | 70/84 [00:09<00:01,  8.14it/s]
  5%|▍         | 4/84 [00:00<00:05, 15.35it/s]
 76%|███████▌  | 64/84 [00:02<00:00, 30.54it/s]
  0%|          | 0/11 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  0%|          | 0/11 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
epoch: 14 	loss: 0.000011   	accuracy: 0.9940 	precision: 0.9931 	recall: 0.9640 	f1: 0.9777
epoch: 14 	loss: 0.027496   	accuracy: 0.8922 	precision: 0.8788 	recall: 0.8342 	f1: 0.8339
                                               python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
                                               python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
OptimizedModule(
  (_orig_mod): BertForSequenceClassification(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): Embedding(32784, 768)
        (position_embeddings): Embedding(512, 768)
        (token_type_embeddings): Embedding(2, 768)
        (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0-11): 12 x BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): Linear(in_features=768, out_features=768, bias=True)
                (key): Linear(in_features=768, out_features=768, bias=True)
                (value): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): BertSelfOutput(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (intermediate): BertIntermediate(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
              (intermediate_act_fn): GELUActivation()
            )
            (output): BertOutput(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (pooler): BertPooler(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): Linear(in_features=768, out_features=5, bias=True)
  )
)
<class 'torch._dynamo.eval_frame.OptimizedModule'>
No traceback available to show.                python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
No traceback available to show.                python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.