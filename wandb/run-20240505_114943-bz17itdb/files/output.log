
/content/drive/MyDrive/research_discourse_relation/discourse_relation_explainability
/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:88: UserWarning:
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
num_added_tokens: 16, added_special_tokens: <NOUN>,<PRONOUN>,<ADJECTIVAL-NOUN>,<PRENOUN-ADJECTIVAL>,<ADVERB>,<CONJUNCTION>,<INTERJECTION>,<VERB>,<ADJECTIVE>,<AUXILIARY-VERB>,<PARTICLE>,<PREFIX>,<SUFFIX>,<SYMBOL>,<AUXILIARY-SYMBOL>,<BLANK>
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at cl-tohoku/bert-base-japanese-v3 and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()



  0%|          | 0/11 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()
epoch: None 	loss: 0.065450   	accuracy: 0.1737 	precision: 0.2217 	recall: 0.2554 	f1: 0.1006
epoch: None 	loss: 0.075550   	accuracy: 0.2321 	precision: 0.1715 	recall: 0.2667 	f1: 0.1020
  0%|          | 0/15 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]




  self.pid = os.fork()[00:00<?, ?it/s]
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
epoch: 0 	loss: 0.001834   	accuracy: 0.7940 	precision: 0.2709 	recall: 0.3063 	f1: 0.2870
epoch: 0 	loss: 0.028216   	accuracy: 0.7904 	precision: 0.2847 	recall: 0.3208 	f1: 0.3014
epoch: 0 	loss: 0.030285   	accuracy: 0.7381 	precision: 0.2704 	recall: 0.2973 	f1: 0.2832
  7%|▋         | 1/15 [01:42<23:50, 10/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






 86%|████████▌ | 72/84 [00:02<00:00, 34.13it/s]
epoch: 1 	loss: 0.001403   	accuracy: 0.8457 	precision: 0.2955 	recall: 0.3266 	f1: 0.3102
epoch: 1 	loss: 0.015931   	accuracy: 0.7964 	precision: 0.2796 	recall: 0.2858 	f1: 0.2799
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 13%|█▎        | 2/15 [01:56<10:58, 50/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






 56%|█████▌    | 47/84 [00:01<00:01, 29.15it/s]
epoch: 2 	loss: 0.000209   	accuracy: 0.8891 	precision: 0.4534 	recall: 0.5273 	f1: 0.4755
epoch: 2 	loss: 0.028444   	accuracy: 0.8323 	precision: 0.4155 	recall: 0.5100 	f1: 0.4434
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  self.pid = os.fork()[00:00<?, ?it/s]






 89%|████████▉ | 75/84 [00:02<00:00, 34.88it/s]
epoch: 3 	loss: 0.000123   	accuracy: 0.9086 	precision: 0.4824 	recall: 0.5339 	f1: 0.4891
epoch: 3 	loss: 0.029439   	accuracy: 0.8383 	precision: 0.4401 	recall: 0.4654 	f1: 0.4249
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 27%|██▋       | 4/15 [02:26<04:53, 26/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






 52%|█████▏    | 44/84 [00:01<00:01, 26.68it/s]
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  9%|▉         | 1/11 [00:00<00:02,  4.40it/s]
epoch: 4 	loss: 0.029304   	accuracy: 0.8323 	precision: 0.4815 	recall: 0.4313 	f1: 0.4415
  self.pid = os.fork()[00:00<?, ?it/s]






 89%|████████▉ | 75/84 [00:02<00:00, 34.11it/s]
epoch: 5 	loss: 0.000052   	accuracy: 0.9708 	precision: 0.9585 	recall: 0.7808 	f1: 0.8004
epoch: 5 	loss: 0.017860   	accuracy: 0.8922 	precision: 0.6353 	recall: 0.7075 	f1: 0.6396
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 40%|████      | 6/15 [02:57<03:00, 20/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]





  self.pid = os.fork()[00:00<?, ?it/s]
  9%|▉         | 1/11 [00:00<00:01,  5.84it/s]
epoch: 6 	loss: 0.000034   	accuracy: 0.9760 	precision: 0.9883 	recall: 0.9133 	f1: 0.9465
epoch: 6 	loss: 0.032256   	accuracy: 0.8503 	precision: 0.6250 	recall: 0.6404 	f1: 0.5873
  self.pid = os.fork()[00:00<?, ?it/s]
 47%|████▋     | 7/15 [03:12<02:28, 18/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






 62%|██████▏   | 52/84 [00:01<00:01, 30.31it/s]
epoch: 7 	loss: 0.000026   	accuracy: 0.9768 	precision: 0.9337 	recall: 0.9268 	f1: 0.9270
epoch: 7 	loss: 0.035289   	accuracy: 0.8563 	precision: 0.8675 	recall: 0.7154 	f1: 0.7426
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  self.pid = os.fork()[00:00<?, ?it/s]






 76%|███████▌  | 64/84 [00:02<00:00, 29.80it/s]
epoch: 8 	loss: 0.000019   	accuracy: 0.9873 	precision: 0.9785 	recall: 0.8549 	f1: 0.8881
epoch: 8 	loss: 0.041966   	accuracy: 0.8443 	precision: 0.6317 	recall: 0.6342 	f1: 0.5910
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 60%|██████    | 9/15 [03:43<01:41, 16/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
  9%|▉         | 1/11 [00:00<00:02,  4.80it/s]
epoch: 9 	loss: 0.000016   	accuracy: 0.9918 	precision: 0.9949 	recall: 0.9319 	f1: 0.9597
epoch: 9 	loss: 0.019780   	accuracy: 0.8683 	precision: 0.6612 	recall: 0.6921 	f1: 0.6435
  self.pid = os.fork()[00:00<?, ?it/s]
 67%|██████▋   | 10/15 [03:58<01:21, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]





 80%|███████▉  | 67/84 [00:09<00:01,  8.56it/s]
 60%|█████▉    | 50/84 [00:01<00:01, 30.75it/s]
epoch: 10 	loss: 0.000014   	accuracy: 0.9940 	precision: 0.9984 	recall: 0.9587 	f1: 0.9776
epoch: 10 	loss: 0.018860   	accuracy: 0.8743 	precision: 0.6502 	recall: 0.6983 	f1: 0.6373
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
  self.pid = os.fork()[00:00<?, ?it/s]






 90%|█████████ | 76/84 [00:02<00:00, 33.44it/s]
epoch: 11 	loss: 0.000013   	accuracy: 0.9940 	precision: 0.9984 	recall: 0.9587 	f1: 0.9776
epoch: 11 	loss: 0.019483   	accuracy: 0.8683 	precision: 0.6395 	recall: 0.6733 	f1: 0.6130
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 80%|████████  | 12/15 [04:29<00:47, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
epoch: 12 	loss: 0.000012   	accuracy: 0.9940 	precision: 0.9984 	recall: 0.9587 	f1: 0.9776
epoch: 12 	loss: 0.018430   	accuracy: 0.8743 	precision: 0.6502 	recall: 0.6983 	f1: 0.6373
epoch: 12 	loss: 0.031953   	accuracy: 0.8452 	precision: 0.8664 	recall: 0.8219 	f1: 0.8209
 87%|████████▋ | 13/15 [04:44<00:31, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]






 71%|███████▏  | 60/84 [00:02<00:00, 31.41it/s]
epoch: 13 	loss: 0.000011   	accuracy: 0.9940 	precision: 0.9984 	recall: 0.9587 	f1: 0.9776
epoch: 13 	loss: 0.018714   	accuracy: 0.8743 	precision: 0.6502 	recall: 0.6983 	f1: 0.6373
  self.pid = os.fork()[00:00<?, ?it/s]
                                      /usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 93%|█████████▎| 14/15 [04:59<00:15, 1/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()[00:00<?, ?it/s]
 33%|███▎      | 28/84 [00:03<00:06,  8.76it/s]
 49%|████▉     | 41/84 [00:05<00:07,  5.91it/s]
 69%|██████▉   | 58/84 [00:08<00:03,  8.07it/s]
 89%|████████▉ | 75/84 [00:10<00:01,  8.73it/s]
 20%|██        | 17/84 [00:00<00:02, 24.73it/s]
 95%|█████████▌| 80/84 [00:02<00:00, 34.85it/s]
 95%|█████████▌| 80/84 [00:02<00:00, 34.85it/s]
epoch: 14 	loss: 0.000011   	accuracy: 0.9940 	precision: 0.9984 	recall: 0.9587 	f1: 0.9776
epoch: 14 	loss: 0.018557   	accuracy: 0.8743 	precision: 0.6502 	recall: 0.6983 	f1: 0.6373
  0%|          | 0/11 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  0%|          | 0/11 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
OptimizedModule(
  (_orig_mod): BertForSequenceClassification(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): Embedding(32784, 768)
        (position_embeddings): Embedding(512, 768)
        (token_type_embeddings): Embedding(2, 768)
        (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0-11): 12 x BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): Linear(in_features=768, out_features=768, bias=True)
                (key): Linear(in_features=768, out_features=768, bias=True)
                (value): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): BertSelfOutput(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
            (intermediate): BertIntermediate(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
              (intermediate_act_fn): GELUActivation()
            )
            (output): BertOutput(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
        )
      )
      (pooler): BertPooler(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): Linear(in_features=768, out_features=5, bias=True)
  )
)
<class 'torch._dynamo.eval_frame.OptimizedModule'>
No traceback available to show.               /python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
No traceback available to show.               /python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.